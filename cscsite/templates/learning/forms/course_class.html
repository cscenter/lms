{% extends "base.html" %}
{% load i18n %}
{% load crispy_forms_tags %}
{% load staticfiles %}
{% load render_bundle from webpack_loader %}

{% block stylesheets %}
    <link href="{% static "css/vendor/bootstrap-datetimepicker.min.css" %}" rel="stylesheet">
{% endblock stylesheets %}

{% block javascripts %}
{# FIXME: Repeated in interviews.html. Do something with that #}
    {% render_bundle 'forms' 'js' %}
    <script type="text/javascript">
        $(function () {
            var TIMEPICKER_ICONS = {
                time: 'fa fa-clock-o',
                date: 'fa fa-calendar',
                up: 'fa fa-chevron-up',
                down: 'fa fa-chevron-down',
                previous: 'fa fa-chevron-left',
                next: 'fa fa-chevron-right',
                today: 'fa fa-screenshot',
                clear: 'fa fa-trash',
                close: 'fa fa-check',
            };
            var TIMEPICKER_TOOLTIPS = {
                today: 'Go to today',
                clear: 'Clear selection',
                close: 'Закрыть',
                selectMonth: 'Выбрать месяц',
                prevMonth: 'Предыдущий месяц',
                nextMonth: 'Следующий месяц',
                selectYear: 'Выбрать год',
                prevYear: 'Предыдущий год',
                nextYear: 'Следующий год',
                selectDecade: 'Выбрать декаду',
                prevDecade: 'Предыдущая декада',
                nextDecade: 'Следующая декада',
                prevCentury: 'Предыдущий век',
                nextCentury: 'Следующий век'
            };

            $('#div_id_date .input-group').datetimepicker({
                allowInputToggle: true,
                locale: 'ru',
                format: 'DD.MM.YYYY',
                stepping: 5,
                toolbarPlacement: "bottom",
                keyBinds: {
                    left: false,
                    right: false,
                    escape: function () {
                        this.hide();
                    },
                },
                icons: TIMEPICKER_ICONS,
                tooltips: TIMEPICKER_TOOLTIPS,

            });

            $('#div_id_starts_at .input-group, #div_id_ends_at .input-group').datetimepicker({
                locale: 'ru',
                format: 'HH:mm',
                stepping: 5,
                useCurrent: false,
                icons: TIMEPICKER_ICONS,
                defaultDate: new Date("01/01/1980 18:00"),
                allowInputToggle: true,
                tooltips: TIMEPICKER_TOOLTIPS,
                keyBinds: {
                    left: false,
                    right: false,
                    up: false,
                    down: false
                }
            });
        });
    </script>
{% endblock javascripts %}

{% block content %}
<div class="container">
  <div class="row">
    <div class="col-xs-12">
        <ol class="breadcrumb projects">
        {% if not form.instance.pk %}
          <li class="active">Добавление нового занятия</li>
            {% else %}
            <li class="active">Редактирование занятия</li>
        {% endif %}
        </ol>
        {% if not form.instance.pk and course_offering.is_completed and not user.is_curator %}
            <div class="alert alert-block alert-warning">
                Курс завершён. Если по какой-то причине вам необходимо добавить новое занятие - обратитесь, пожалуйста, к кураторам.
            </div>
        {% else %}
            {% crispy form form.helper %}
        {% endif %}
    </div>
  </div>
</div>
{% endblock content %}

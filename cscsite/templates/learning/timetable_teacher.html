{% extends "base.html" %}
{% load i18n %}

{% block content %}
{% regroup object_list by date|date:"l, d E Y" as classes_by_day %}
<div class="container">
  <div class="row timetable-header-row">
    <div class="col-xs-12 h2-and-buttons">
      <h2>{{ current_date|date:"F, Y" }}</h2>
      <div class="btn-toolbar">
        <div class="btn-group">
          <a href="?year={{ prev_date.year }}&month={{ prev_date.month }}" role="button" class="btn btn-default"><i class="fa fa-chevron-left"></i></a>
          <a href="?year={{ next_date.year }}&month={{ next_date.month }}" role="button" class="btn btn-default"><i class="fa fa-chevron-right"></i></a>
        </div>
        <div class="btn-group">
          <a href="{% if user_type == 'teacher' %}
                   {% url 'timetable_teacher' %}
                   {% else %}
                   {% url 'timetable_student' %}
                   {% endif %}"
             role="button"
             class="btn btn-default active">{% trans 'List' %}</a>
          <a href="{% if user_type == 'teacher' %}{% url 'calendar_teacher' %}{% else %}{% url 'calendar_student' %}{% endif %}?year={{ year }}&month={{ month }}"
             role="button"
             class="btn btn-default">{% trans 'Calendar' %}</a>
        </div>
      </div>
      <hr>
    </div>
  </div>
  {% if object_list %}
  <div class="row timetable-main-row">
    <div class="col-xs-12">
      {% for day in classes_by_day %}
      <h4>{{ day.grouper }}</h4>
      <table class="table timetable" width="100%">
        <thead>
          <th width="15%">{% trans "Time" %}</th>
          <th>{% trans "Class|Name" %}</th>
          <th width="15%">{% trans "Course" %}</th>
          <th width="12%">{% trans "Venue|short" %}</th>
          <th width="10%"></th>
          <th width="10%">{% trans "Materials" %}</th>
        </thead>
        {% for class in day.list %}
        <tr>
          <td>{{ class.starts_at|time:"H:i" }}â€“{{ class.ends_at|time:"H:i" }}</td>
          <td>
            <a href="{% url 'class_detail' class.course_offering.course.slug class.course_offering.semester.slug class.pk %}">
              {{ class.name }}
            </a>
          </td>
          <td>
            <a href="{% url 'course_offering_detail' class.course_offering.course.slug class.course_offering.semester.slug %}">
              {{ class.course_offering.course.name }}
            </a>
          </td>
          <td>
            <a href="{% url 'venue_detail' class.venue.pk %}">
              {{ class.venue }}
            </a>
          </td>
          <td>
            {% if class.type == 'lecture' %}
            <span class="badge lecture">{% trans 'Lecture' %}</span>
            {% else %}
            <span class="badge seminar">{% trans 'Seminar' %}</span>
            {% endif %}
          </td>
          <td>
            <ul class="list-unstyled no-margin">
              {% if class.slides %}
              <li>
                <a href="{% url 'course_class_edit' class.course_offering.course.slug class.course_offering.semester.slug class.pk %}#div_id_slides">
                  {% trans "Slides" %}
                </a>
              </li>
              {% endif %}
              {% if class.video_url %}
              <li>
                <a href="{% url 'course_class_edit' class.course_offering.course.slug class.course_offering.semester.slug class.pk %}#div_id_video_url">
                  {% trans "Video" %}
                </a>
              </li>
              {% endif %}
              {% if not class.slides and not class.video %}
              <li>
                <a href="{% url 'course_class_edit' class.course_offering.course.slug class.course_offering.semester.slug class.pk %}#div_id_slides">
                  {% trans "No" %}
                </a>
              </li>
              {% endif %}
            </ul>
          </td>
        </tr>
        {% endfor %}
      </table>
      {% endfor %}
    </div>
  </div>
  {% else %}
  <div class="row">
    <div class="col-xs-12 center-aligned">
      <h4>{% trans "No classes yet" %}</h4>
    </div>
  </div>
  {% endif %}
</div>
{% endblock content %}

{% extends "base.html" %}

{% load i18n %}

{% load core_tags %}

{% block content %}
    <div class="container">
        <div id="library" class="row">
            <h2 class="content-title">
                {% trans "library"|capfirst %}
                {% if user.is_authenticated and user.is_curator %}
                    <a href="{% admin_url stocks %}" target="_blank" class="btn btn-link">
                        <i class="fa fa-pencil"></i>
                    </a>
                {% endif %}
            </h2>

            <p>
                {% blocktrans %}
                    HOWTO instructions. Do we even need i18n here?
                {% endblocktrans %}
            </p>

            <table class="table table-bordered">
                <thead>
                <tr class="active">
                    <th>{% trans "Book|title"|capfirst %}</th>
                    <th>{% trans "Book|author"|capfirst %}</th>
                    <th>{% trans "Book|read by"|capfirst %}</th>
                    <th>{% trans "Book|number of copies left"|capfirst %}</th>
                    {% if user.is_curator %}<th>Город</th>{% endif %}
                </tr>
                </thead>
                <tbody>
                {% for stock in stocks %}
                    <tr{% if stock.pk in borrowed %} class="warning"{% endif %}>
                        <td>
                            <a href="{{ stock.get_absolute_url }}">
                                {{ stock.book.title }}
                            </a>
                        </td>
                        <td><em>{{ stock.book.author }}</em></td>
                        <td>
                            {% if stock.borrows.exists %}
                                <p>
                                    {% include "library/_borrowed_by.html" %}
                                </p>
                            {% endif %}
                        </td>
                        <td>{{ stock.available_copies }}</td>
                        {% if user.is_curator %}<td>{{ stock.city.abbr }}</td>{% endif %}
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}

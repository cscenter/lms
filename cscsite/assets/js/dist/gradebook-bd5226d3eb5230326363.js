webpackJsonp([0],{"4N7q":function(e,t,n){"use strict";function r(e){var t=window.event?e.keyCode:e.which;return!(t>31&&(t<48||t>57))}function o(e){return e.value!==e.getAttribute("initial")}Object.defineProperty(t,"__esModule",{value:!0});var a=n("in4f"),i=(n.n(a),n("SLSV")),c=n.n(i),s=$(".marks-sheet-csv-link"),l=$("#marks-sheet-save"),u=$("#gradebook-container"),m=$("#gradebook"),d=$(".gradebook__controls"),f={launch:function(){f.restoreStates(),f.finalGradeSelects(),f.submitForm(),f.downloadCSVButton(),f.assignmentGradeInputValidator(),f.assignmentGradeInputIncrementByArrows(),f.scrollButtons()},restoreStates:function(){var e=document.querySelectorAll("#gradebook .__input");Array.prototype.forEach.call(e,f.toggleState);var t=document.querySelectorAll("#gradebook select");Array.prototype.forEach.call(t,f.toggleState)},downloadCSVButton:function(){s.click(function(){if(m.find(".__unsaved").length>0)return c()({title:"",text:"Сперва сохраните форму,\nчтобы скачать актуальные данные.",type:"warning",confirmButtonText:"Хорошо"}),!1})},submitForm:function(){l.removeAttr("disabled"),$("form[name=gradebook]").submit(function(e){var t=this.querySelectorAll(".__input, .__final_grade select");Array.prototype.forEach.call(t,function(e){if(!o(e)){e.disabled=!0;var t="input[name=initial-"+e.name+"]";document.querySelector(t).disabled=!0}})})},finalGradeSelects:function(){m.on("change","select",function(e){f.toggleState(e.target)})},assignmentGradeInputValidator:function(){m.on("keypress","input.__assignment",r),m.on("change","input.__assignment",function(e){var t=parseInt(this.value,10);if($.isNumeric(this.value)&&Number.isInteger(t)){var n=parseInt($(this).attr("max"));t<0?this.value=0:t>n&&(this.value=n)}else this.value="";f.toggleState(e.target)})},toggleState:function(e){var t=void 0;"input"===e.nodeName.toLowerCase()?t=e:"select"===e.nodeName.toLowerCase()&&(t=e.parentElement),o(e)?t.classList.add("__unsaved"):t.classList.remove("__unsaved")},assignmentGradeInputIncrementByArrows:function(){m.on("keydown","input.__assignment",function(e){if(38===e.keyCode||40===e.keyCode){var t=this;void 0!==t.increment&&void 0!==t.decrement||(t.increment=$.arrowIncrement.prototype.increment,t.decrement=$.arrowIncrement.prototype.decrement),t.opts={parseFn:function(e){var t=e.match(/^(\D*?)(\d*(,\d{3})*(\.\d+)?)\D*$/);return t&&t[2]?t[1]&&t[1].indexOf("-")>=0?-t[2].replace(",",""):+t[2].replace(",",""):0===e.length?0:NaN}},t.$element=$(this),38===e.keyCode?t.increment():40===e.keyCode&&t.decrement()}})},scrollButtons:function(){u.width()<=m.width()&&(d.on("click",".scroll.left",function(){f.scroll(-1)}),d.on("click",".scroll.right",function(){f.scroll(1)}),d.css("visibility","visible"))},scroll:function(e){var t=100*parseInt(e);if(0!==t){var n=u.scrollLeft();u.scrollLeft(n+t)}}};t.default=f},in4f:function(e,t){!function(e){e.arrowIncrement=function(t,n){var r=this;this.opts=e.extend({},n),this.$element=e(t).keydown(function(e){38===e.keyCode?r.increment():40===e.keyCode&&r.decrement()})},e.arrowIncrement.prototype.increment=function(t){var n,r,o=this.$element.val();n=this.opts.parseFn?this.opts.parseFn(o):e.arrowIncrement.parse(o),isNaN(n)||(r=e.arrowIncrement.compute(n,t,this.opts),this.opts.formatFn&&(r=this.opts.formatFn(r)),this.$element.val(r).change())},e.arrowIncrement.prototype.decrement=function(){this.increment(!0)},e.arrowIncrement.compute=function(t,n,r){var o,a,i=1,c=r&&"number"==typeof r.min,s=r&&"number"==typeof r.max;if(r&&"number"==typeof r.delta&&(i=r.delta),n){if(c&&t<r.min)return t;o=t-i}else{if(s&&t>r.max)return t;o=t+i}return a=Math.max(e.arrowIncrement.decimals(t),e.arrowIncrement.decimals(i)),o=+o.toFixed(a),c&&o<r.min&&(o=r.min),s&&o>r.max&&(o=r.max),o},e.arrowIncrement.decimals=function(e){var t=""+e;return t.indexOf(".")>=0?t.length-1-t.indexOf("."):0},e.arrowIncrement.parse=function(e){var t=e.match(/^(\D*?)(\d*(,\d{3})*(\.\d+)?)\D*$/);return t&&t[2]?t[1]&&t[1].indexOf("-")>=0?-t[2].replace(",",""):+t[2].replace(",",""):NaN},e.fn.arrowIncrement=function(t){return this.each(function(){new e.arrowIncrement(this,t)})}}(jQuery)}});